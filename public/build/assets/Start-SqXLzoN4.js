import{r,j as e,H as G,a as x,L as B}from"./app-C_cz8bv4.js";import{z as l,A}from"./AuthenticatedLayout-QOrDlllg.js";import{n as $,A as R,u as D,B as F,k as T,z as y,b as H,L as U,y as z}from"./index-D4k7EDuT.js";import{M as K}from"./index-VkyIWw6y.js";import I from"./PauseGameModal-B-8kCBYy.js";import O from"./EndGameModal-mPm1Rnk4.js";import"./transition-Bf3tepnj.js";function ee({game:u,current_word:N,statistics:h,recent_words:w}){const[a,p]=r.useState(u.data),[d,n]=r.useState(!1),[v,j]=r.useState(!1),[_,f]=r.useState(!1),[c,S]=r.useState(N||null),[m,L]=r.useState(w||[]),[g,C]=r.useState({totalWords:h.total_words||0,wordsRemaining:h.words_remaining||0,playersWithBingo:h.calledWordsCount||0});r.useEffect(()=>{p(u.data)},[u.data]),r.useEffect(()=>(Echo.channel(`game.${a.game_code}`).listen(".player.joined",s=>{console.log("Player joined:",s),p(t=>({...t,players:[...t.players,s.player]})),l.success(s.message)}).listen(".player.left",s=>{console.log("Player left:",s),p(t=>({...t,players:t.players.filter(i=>i.id!==s.player.id)})),l.error(s.message)}).error(s=>{console.error("Echo error:",s)}),()=>{Echo.leaveChannel(`game.${a.game_code}`)}),[a.game_code]);const M=async()=>{n(!0);try{const s=await axios.post(route("games.call-word",a.game_code));if(s.data.current_word){const t=s.data.current_word;S(t),L(i=>[...i,t]),C({totalWords:s.data.statistics.total_words,wordsRemaining:s.data.statistics.words_remaining,playersWithBingo:g.playersWithBingo})}s.data.game_completed&&(l.success("Game completed! All words have been called."),x.reload())}catch(s){s.response?.data?.message?(alert(s.response.data.message),l.error(s.response.data.message)):l.error("Failed to call next word. Please try again.")}finally{n(!1)}},W=async()=>{n(!0);const s=a.can_pause,t=a.can_resume,i=t?"resume":"pause";try{const o=s?"games.pause":"games.resume";await axios.post(route(o,a.game_code));const b=t?"Game resumed successfully!":"Game paused successfully!";l.success(b),j(!1),x.reload({only:["game"]})}catch(o){if(console.error(`Error ${i}ing game:`,o),o.response?.data?.message)l.error(o.response.data.message);else{const b=t?"Failed to resume game. Please try again.":"Failed to pause game. Please try again.";l.error(b)}}finally{n(!1)}},P=()=>{n(!0),x.post(route("games.end",a.game_code),{},{onSuccess:()=>{f(!1),n(!1),l.success("Game ended!")},onError:()=>{n(!1)}})},k=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),E=s=>({joined:"bg-blue-100 text-blue-800",playing:"bg-green-100 text-green-800",won:"bg-yellow-100 text-yellow-800",disconnected:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800";return e.jsxs(A,{header:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-400 to-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(U,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:["Laro: ",a.game_code]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[a.word_bank?.name," â€¢ ",a.status]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>j(!0),disabled:d,className:`inline-flex items-center px-4 py-2 ${a.can_resume?"bg-green-600 hover:bg-green-700":"bg-orange-600 hover:bg-orange-700"} disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors duration-200 shadow-sm`,children:a.can_resume?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Resume"]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Pause"]})}),e.jsxs("button",{onClick:()=>f(!0),disabled:d,className:"inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors duration-200 shadow-sm",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"End Game"]})]})]}),children:[e.jsx(G,{title:`Game ${a.game_code} - Active`}),e.jsx("div",{className:"py-6 sm:py-8",children:e.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>x.visit(route("games.index")),className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx($,{className:"w-4 h-4 mr-1"}),"Back to Games"]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Kasalukuyang Salita"}),c?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-32 h-32 mx-auto bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center mb-4",children:e.jsx("span",{className:"text-3xl font-bold text-white",children:c.word||"Tawagin ang unang salita"})}),e.jsx("p",{className:"text-gray-600 text-lg mb-6",children:c.meaning||""})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(R,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Handa nang tawagin ang unang salita"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:M,disabled:d,className:"inline-flex items-center px-8 py-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors duration-200 shadow-sm text-lg",children:[d?e.jsx(D,{className:"w-5 h-5 mr-3 animate-spin ml-2"}):e.jsx(F,{className:"w-5 h-5 mr-3 ml-2"}),e.jsx("span",{className:"mr-2",children:c?"Tawagin ang Susunod na Salita":"Tawagin ang Unang Salita"})]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Estadistika ng Laro"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:m.length}),e.jsx("div",{className:"text-sm text-blue-800",children:"Mga Salitang Tinawag"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:g.wordsRemaining}),e.jsx("div",{className:"text-sm text-green-800",children:"Mga Natitirang Salita"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:g.playersWithBingo}),e.jsx("div",{className:"text-sm text-purple-800",children:"Mga Manlalarong may Bingo"})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Mga Tinawag na Salita"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[m.length," of"," ",g.totalWords]})]}),m.length>0?e.jsx("div",{className:"max-h-64 overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2",children:m.slice().reverse().map((s,t)=>e.jsx("div",{className:`p-3 text-center rounded-lg border ${t===0?"bg-blue-100 border-blue-300 text-blue-800":"bg-gray-50 border-gray-200 text-gray-700"}`,children:e.jsx("div",{className:"font-medium",children:s.word})},s.id))})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(T,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Wala pang tinawag na salita"})]})]})})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Impormasyon ng Laro"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Katayuan"}),e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-lg text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(y,{className:"w-3 h-3 mr-1"}),"Aktibo"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Nagsimula"}),e.jsx("span",{className:"text-sm text-gray-900",children:k(a.started_at||a.created_at)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Word Bank"}),e.jsx("span",{className:"text-sm text-gray-900",children:a.word_bank?.name})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(H,{className:"w-5 h-5 mr-2"}),"Mga Manlalaro"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[a.players.length,"/",a.max_players]})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:a.players&&a.players.length>0?a.players.map((s,t)=>e.jsxs(B,{href:route("games.players.show",[a.game_code,s.id]),as:"div",className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full flex items-center justify-center text-white font-medium text-sm",children:s.name?s.name.charAt(0).toUpperCase():t+1}),e.jsx("div",{className:"ml-3",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name||`Player ${t+1}`})})]}),e.jsx("span",{className:`px-2 py-1 inline-flex items-center font-medium rounded-lg border text-xs ${E(s.status_info.label.toLowerCase())}`,children:s.status_info.label})]},s.id||t)):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-sm text-gray-600",children:"Walang mga manlalaro"})})})]})})]})]})]})}),e.jsx(I,{show:v,onClose:()=>j(!1),onConfirm:W,loading:d,isPaused:a.status==="paused"}),e.jsx(O,{show:_,onClose:()=>f(!1),onConfirm:P,loading:d})]})}export{ee as default};
